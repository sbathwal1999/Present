<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv=""X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content ="width=device-width, initial-scale=1.0">
    <title>CV</title>
  </head>
  <body>
    <div class="container">
      <div class="row">
        <div class="col-lg-8 offset-lg-2">
          <h3 class="mt-5">Live Streaming</h3>
          <img id="video" src="{{ url_for('video') }}" width="50%" >
        <div class="col-lg-8 offset-lg-2">
          <button
            id="btnPip"
            style="display: none"
            type="button"
            class="button"
          >
            Enter Picture-in-Picture
          </button>
        </div>
      </div>
    </div>
    <script>
      const video = document.querySelector("#video");
      const btnPip = document.querySelector("#btnPip");

      async function videoStream(){
        try{
          const stream = await navigator.mediaDevices.getDisplayMedia();
          videoElement.srcObject = stream;
          videoElement.onloadedmetadata = () => {
            videoElement.play()
          }
        }
        catch(error){
          console.log('error')
        }
      }

      if ("pictureInPictureEnabled" in document) {
        btnPip.style.display = null;

        btnPip.addEventListener("click", async() => {
          video.requestPictureInPicture().catch((err) => {
            console.log(err);
          });
        });
      }
    </script>
  </body>
</html>
